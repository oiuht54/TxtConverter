<Window x:Class="TxtConverter.Views.SelectionWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:models="clr-namespace:TxtConverter.Core.Models"
        WindowStyle="None" ResizeMode="CanResize"
        Width="600" Height="750"
        WindowStartupLocation="CenterOwner"
        Title="Select Files" Background="{StaticResource Brush_WindowBg}">

    <WindowChrome.WindowChrome>
        <WindowChrome CaptionHeight="40" ResizeBorderThickness="5" GlassFrameThickness="0" CornerRadius="0"/>
    </WindowChrome.WindowChrome>

    <Border BorderBrush="#333333" BorderThickness="1">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Title Bar -->
            <Grid Grid.Row="0" Background="{StaticResource Brush_WindowBg}" MouseDown="TitleBar_MouseDown" Height="40">
                <TextBlock Text="{DynamicResource ui_select_files_btn}" FontWeight="Bold" Foreground="#888888" Margin="15,0" VerticalAlignment="Center"/>
                <Button Style="{StaticResource CloseButton}" HorizontalAlignment="Right" Click="Cancel_Click" Content="X" WindowChrome.IsHitTestVisibleInChrome="True"/>
            </Grid>

            <!-- Toolbar -->
            <Grid Grid.Row="1" Margin="20,10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="200"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBlock Text="Group By: " VerticalAlignment="Center" Margin="0,0,10,0" Foreground="{StaticResource Brush_Fg}"/>
                <ComboBox x:Name="ViewModeCombo" Grid.Column="1" SelectionChanged="ViewMode_Changed">
                    <ComboBoxItem Content="Type (Extensions)" IsSelected="True"/>
                    <ComboBoxItem Content="Folder Structure"/>
                </ComboBox>

                <StackPanel Grid.Column="3" Orientation="Horizontal">
                    <Button Content="Select All" Click="SelectAll_Click" Margin="0,0,10,0"/>
                    <Button Content="Select None" Click="SelectNone_Click"/>
                </StackPanel>
            </Grid>

            <!-- TreeView Container -->
            <Border Grid.Row="2" Margin="20,0,20,15" Style="{StaticResource CardBorder}" Padding="0">
                <TreeView x:Name="FileTree" BorderThickness="0" Padding="5" Background="Transparent">
                    <TreeView.ItemTemplate>
                        <HierarchicalDataTemplate DataType="{x:Type models:FileTreeNode}" ItemsSource="{Binding Children}">
                            <StackPanel Orientation="Horizontal" Margin="0,2">
                                <CheckBox IsChecked="{Binding IsChecked}" Margin="0,0,8,0" VerticalAlignment="Center" Focusable="False"/>
                                <TextBlock Text="{Binding Name}" VerticalAlignment="Center" Foreground="{StaticResource Brush_Fg}"/>
                            </StackPanel>
                        </HierarchicalDataTemplate>
                    </TreeView.ItemTemplate>
                </TreeView>
            </Border>

            <!-- Footer -->
            <Grid Grid.Row="3" Margin="20,0,20,20">
                <TextBlock x:Name="InfoLabel" Text="Selected: 0" Foreground="{StaticResource Brush_Accent}" FontWeight="Bold" VerticalAlignment="Center"/>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button Content="Cancel" Click="Cancel_Click" Margin="0,0,10,0" MinWidth="80"/>
                    <Button Content="Confirm" Style="{StaticResource AccentButton}" Click="Confirm_Click" MinWidth="100"/>
                </StackPanel>
            </Grid>
        </Grid>
    </Border>
</Window>
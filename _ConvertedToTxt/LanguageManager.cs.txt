using System.Windows;
using TxtConverter.Core;
namespace TxtConverter.Services;
public class LanguageManager
{
private static LanguageManager? _instance;
public static LanguageManager Instance => _instance ??= new LanguageManager();
private LanguageManager() { }
public string CurrentLanguage { get; private set; } = ProjectConstants.LangEn;
public void SetLanguage(string languageCode)
{
var uri = new Uri($"pack://application:,,,/Resources/Lang/Strings.{languageCode}.xaml");
try
{
var dict = new ResourceDictionary { Source = uri };
Application.Current.Resources.MergedDictionaries.Clear();
Application.Current.Resources.MergedDictionaries.Add(dict);
var styles = new ResourceDictionary { Source = new Uri("pack://application:,,,/Resources/Styles.xaml") };
Application.Current.Resources.MergedDictionaries.Add(styles);
CurrentLanguage = languageCode;
PreferenceManager.Instance.SetLanguage(languageCode);
}
catch (Exception ex)
{
System.Diagnostics.Debug.WriteLine($"Error loading language {languageCode}: {ex.Message}");
}
}
public string GetString(string key)
{
if (Application.Current.Resources.Contains(key))
{
return Application.Current.Resources[key] as string ?? $"!{key}!";
}
return $"!{key}!";
}
}